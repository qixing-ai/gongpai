# 工牌设计器组件说明

## 网格化OBJ导出功能 (新增)

### 功能特点
- **密集三角网格**：正面和背面采用规则网格划分，生成密集的三角面
- **可调网格密度**：支持10x10到50x50的网格密度设置
- **智能边界连接**：可控制边界连接数量，避免背面网格凌乱
- **水密结构**：保持原有的水密特性，适合3D打印
- **便于后续操作**：密集的三角面网格便于进行网格编辑、细分、变形等操作

### 使用方法
1. 在导出设置面板中调整"网格密度"
2. 宽度和高度分别控制对应方向的网格分段数
3. 在"网格质量"设置中控制边界连接：
   - 启用/禁用边界连接
   - 调整最大连接数（1-8个）
4. 默认设置为20x20网格，平衡质量和性能
5. 点击"导出OBJ模型"即可生成网格化模型

### 网格密度建议
- **低密度 (10-30)**：文件小，适合预览和快速原型
- **中密度 (30-100)**：平衡质量和文件大小，推荐日常使用
- **高密度 (100-300)**：高质量，适合精细操作，文件较大
- **超高密度 (300-1000)**：极高质量，适合专业建模、仿真或雕刻，文件很大，处理时间长

⚠️ **超高密度使用注意事项**：
- 网格密度超过200时，文件大小和处理时间会显著增加
- 建议根据实际需要选择合适的密度，避免不必要的性能消耗
- 大部分3D打印和建模应用，100-200的密度已经足够
- 超高密度主要用于精密工程、科学仿真或艺术雕刻等专业场景

### 网格质量控制
- **启用边界连接**：确保模型水密性，但可能产生少量不规则三角形
- **禁用边界连接**：获得最干净的网格，但可能影响水密性
- **最大连接数**：控制边界连接的数量，数值越小背面越干净

### 背面网格凌乱问题解决方案
**问题原因**：
- 边界连接算法过于复杂，产生大量不规则三角形
- 网格与边界连接方式不当，在边界附近产生凌乱面

**解决方案**：
1. **简化边界连接**：重新设计连接算法，减少不必要的三角形
2. **可控制连接数**：允许用户设置最大边界连接数（1-8个）
3. **可选边界连接**：提供禁用边界连接的选项，获得最干净的网格
4. **优化UV映射**：背面使用镜像UV坐标，确保贴图正确

**推荐设置**：
- **追求干净网格**：禁用边界连接
- **平衡质量和清洁度**：启用边界连接，最大连接数设为2-3
- **确保水密性**：启用边界连接，最大连接数设为5-8

### 技术特性
- 使用改进的多边形点包含算法判断网格点位置
- 智能边界连接算法，减少凌乱三角形
- 支持带孔洞的复杂几何体网格化
- 保持UV贴图的准确映射
- 背面UV坐标自动镜像处理

### 输出文件
- `badge.obj`：包含网格化几何体的主文件
- `badge.mtl`：材质定义文件
- `badge_texture.png`：UV贴图文件

所有文件都包含网格化相关的元数据注释，便于识别和后续处理。

## 其他组件

### BadgePreview
工牌预览组件，实时显示设计效果。

### BadgeSettings  
工牌基本设置，包括尺寸、背景色、圆角等。

### TextSettings
文字和导出设置，现已包含网格密度和质量控制。

### OBJColorConverter
OBJ模型颜色转换工具（独立功能）。

## 组件结构

### BadgePreview.js
工牌预览组件，负责：
- 渲染工牌的可视化预览
- 处理元素选中状态的视觉反馈
- 渲染调整手柄
- 显示拖拽提示
- 显示尺寸信息

### BadgeSettings.js
工牌设置组件，负责：
- 工牌尺寸设置（宽度、高度、圆角、背景色）
- 穿孔设置（形状、大小、位置）
- 图片设置（上传、尺寸、位置、透明度）

### TextSettings.js
文字设置组件，负责：
- 文字内容编辑
- 字体选择
- 字号、颜色设置
- 文字位置调整
- 行高设置

## 相关文件

### hooks/useInteraction.js
交互逻辑Hook，处理：
- 拖拽交互
- 尺寸调整
- 键盘快捷键
- 选中状态管理

### constants/unitConfig.js
单位配置常量，定义：
- 尺寸限制
- 单位转换
- 预览缩放比例

## 组件间通信

所有组件通过props接收状态和回调函数，保持单向数据流：
- 状态由父组件（BadgeDesigner）管理
- 交互逻辑由useInteraction Hook处理
- 各组件只负责UI渲染和用户输入 